# 贡献指南

首先，感谢您抽出时间为 TL-Rustscan 做出贡献！

以下是为 TL-Rustscan 做出贡献的一套指南。这些主要是建议，并非强制规则。请根据您的判断行事，并随时在 Pull Request 中建议更改本文档。

## 我该如何贡献？

### 核心原则：精准度优先

TL-Rustscan 的首要目标是**精准**。在提交代码时，请务必遵循以下原则：

1.  **宁缺毋滥**: 如果一个指纹规则可能会导致大量误报（如匹配了通用的 "404 Not Found" 页面），请不要添加它，或者增加更严格的约束条件（如限定 Header 或 Title）。
2.  **考虑边界情况**: 您的代码能否处理网络超时？能否处理数据包分片？能否处理非标准的 HTTP 响应？
3.  **避免阻塞**: 所有的 I/O 操作必须是异步的 (Async) 或在独立线程中运行，严禁在核心循环中进行阻塞操作。

### 报告 Bug

本节将指导您提交 TL-Rustscan 的 Bug 报告。遵循这些指南有助于维护者和社区理解您的报告，重现行为并找到相关报告。

*   **使用清晰且描述性的标题**来标识问题。
*   **尽可能详细地描述重现问题的确切步骤**。
*   **提供具体的示例来演示步骤**。包括您在这些示例中使用的文件或 GitHub 项目的链接，或可复制/粘贴的代码片段。
*   **描述您在执行步骤后观察到的行为**，并指出该行为具体有什么问题。
*   **解释您期望看到的行为以及原因。**
*   **包含屏幕截图和 GIF 动图**，展示您执行所述步骤并清楚地演示问题。

### 提交 Pull Request (PR)

*   填写所需的模板。
*   不要在 PR 标题中包含 Issue 编号。
*   尽可能在您的 Pull Request 中包含屏幕截图和 GIF 动图。
*   遵循 Rust 编码风格。
*   确保所有测试通过 (`cargo test`)。

### 添加指纹

如果您想添加新的服务指纹，请优先考虑更新 `fingerprints.json` 文件，而不是硬编码在 Rust 代码中。
该文件支持以下字段：
*   `name`: 指纹名称 (如 "Spring Boot")
*   `match_mode`: 匹配模式 (支持 "keyword" 或 "regex")
*   `pattern`: 匹配的关键词或正则表达式。
    *   **Keyword**: 自动不区分大小写。
    *   **Regex**: 默认为大小写敏感。如需不区分大小写，请在正则开头添加 `(?i)`。
    *   **注意**: Rust 正则不支持反向引用 `\1` 和前瞻/后顾断言 `(?=)`, `(?<!)` 等。
*   `location`: 匹配位置 ("body", "header", "banner", "title")

## 风格指南

### Git 提交信息

*   使用现在时 ("Add feature" 而不是 "Added feature")
*   使用祈使语气 ("Move cursor to..." 而不是 "Moves cursor to...")
*   第一行限制在 72 个字符以内
*   在第一行之后自由引用 Issue 和 Pull Request

### Rust 风格指南

*   使用 `cargo fmt` 格式化您的代码。
*   使用 `cargo clippy` 检查常见错误。

### 添加红队插件 (Red Team Plugins)

如果您想添加新的漏洞 POC 或爆破模块，请遵循以下步骤：

1.  **代码位置**: 所有插件代码应位于 `src/plugins/` 目录下。
2.  **实现 Trait**: 新插件必须实现 `ScanPlugin` trait。
    *   `name()`: 返回插件名称。
    *   `is_rscan_only()`: 如果是攻击性插件（爆破/漏洞），必须返回 `true`。
    *   `scan()`: 执行具体的扫描逻辑。
3.  **注册插件**: 在 `src/plugins/mod.rs` 中的 `PluginManager::new` 函数中注册您的新插件。
4.  **安全性**: 确保您的 POC 是安全的，只进行验证（如 `whoami` 或 `version`），**严禁**包含破坏性操作（如 `rm -rf` 或上传 Webshell）。

感谢您的贡献！
